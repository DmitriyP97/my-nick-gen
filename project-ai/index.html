<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7647223205847224"
     crossorigin="anonymous"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project AI: –¢–µ—Å—Ç –ê—é–º—É –Ω–∞ –ø–∞–º—è—Ç—å</title>
    <meta name="description" content="–í–µ–±-–≤–µ—Ä—Å–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ Project AI (–¢–µ—Å—Ç –ê—é–º—É). –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ—é –∫—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω—É—é –ø–∞–º—è—Ç—å, –∑–∞–ø–æ–º–∏–Ω–∞—è —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ü–∏—Ñ—Ä –∑–∞ –¥–æ–ª–∏ —Å–µ–∫—É–Ω–¥—ã.">
    <style>
        :root {
            --bg-body: #0f0f0f; --text-main: #e0e0e0; --bg-card: #1a1a1a; --border-card: #333;
            --shadow-card: 0 10px 30px rgba(0,0,0,0.8); --bg-element: #252525; --border-element: #444;
            --text-muted: #888; --text-label: #aaa; --bg-input: #121212; --text-input: #ffffff;
            --h1-color: #00d4ff; --text-on-accent: #000000; --success-color: #00ffaa; --error-color: #ff4d4d;
        }
        [data-theme="light"] {
            --bg-body: #f0f2f5; --text-main: #333333; --bg-card: #ffffff; --border-card: #ddd;
            --shadow-card: 0 10px 30px rgba(0,0,0,0.1); --bg-element: #f8f9fa; --border-element: #ddd;
            --text-muted: #666; --text-label: #555; --bg-input: #ffffff; --text-input: #333333;
            --h1-color: #007bff; --text-on-accent: #ffffff; --success-color: #28a745; --error-color: #dc3545;
        }

        body { font-family: 'Segoe UI', sans-serif; background: var(--bg-body); color: var(--text-main); margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; min-height: 100vh; transition: background 0.3s, color 0.3s; }
        .card { background: var(--bg-card); padding: 20px; border-radius: 10px; box-shadow: var(--shadow-card); width: 100%; max-width: 500px; border: 1px solid var(--border-card); position: relative; z-index: 2; transition: background 0.3s, border-color 0.3s; }
        h1 { color: var(--h1-color); margin: 0 0 20px 0; font-size: 32px; text-align: center; }
        
        .control-group { text-align: left; margin-bottom: 15px; background: var(--bg-element); padding: 15px; border-radius: 10px; }
        label { display: block; margin-bottom: 8px; font-weight: bold; font-size: 14px; color: var(--text-label); }
        select, input[type="number"] { width: 100%; padding: 10px; border-radius: 5px; border: 1px solid var(--border-element); background: var(--bg-input); color: var(--text-input); box-sizing: border-box; font-size: 16px; }
        
        button { background: linear-gradient(45deg, #00d4ff, #0055ff); color: white; border: none; padding: 15px; font-size: 18px; border-radius: 10px; cursor: pointer; font-weight: bold; transition: 0.3s; width: 100%; }
        button:hover { transform: scale(1.02); box-shadow: 0 5px 15px rgba(0,85,255,0.4); }
        button:active { transform: scale(0.98); }
        
        .theme-btn { position: absolute; top: 20px; right: 20px; background: var(--bg-element); color: var(--text-main); border: 1px solid var(--border-element); width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px; padding: 0; box-shadow: 0 2px 10px rgba(0,0,0,0.2); cursor: pointer; z-index: 100; transition: 0.3s; }
        .theme-btn:hover { transform: scale(1.1); }

        /* Navigation Styles */
        .nav-container { position: fixed; top: 20px; left: 20px; z-index: 1000; }
        .nav-menu { background: var(--bg-card); border: 1px solid var(--border-card); border-radius: 10px; padding: 10px; display: none; flex-direction: column; gap: 8px; box-shadow: var(--shadow-card); width: 220px; transition: all 0.3s ease; position: absolute; top: 50px; left: 0; }
        .nav-menu.show { display: flex; }
        .nav-link { text-decoration: none; color: var(--text-main); padding: 10px; border-radius: 5px; transition: background 0.2s; display: block; font-size: 14px; }
        .nav-link:hover { background: var(--bg-element); }
        .nav-link.active { background: var(--h1-color); color: var(--text-on-accent); font-weight: bold; }
        .nav-toggle { display: flex; align-items: center; justify-content: center; height: 40px; background: var(--bg-element); color: var(--text-main); border: 1px solid var(--border-element); padding: 0 15px; border-radius: 20px; cursor: pointer; font-size: 14px; font-weight: bold; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }

        /* --- Game Specific Styles --- */
        #game-area {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: var(--bg-body);
            z-index: 5000;
            padding: 20px;
            box-sizing: border-box;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        #game-stats {
            display: flex;
            justify-content: space-between;
            width: 50%;
            margin-bottom: 15px;
            font-size: 16px;
            color: var(--text-muted);
            font-weight: bold;
        }

        /* –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ - –∏–º–∏—Ç–∞—Ü–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ */
        #grid-container {
            display: grid;
            background-color: #6f6c6c; /* –ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π —Ñ–æ–Ω, –∫–∞–∫ –≤ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ */
            border: 4px solid #b5b5b5;
            border-radius: 4px;
            width: 100%;
            flex-grow: 1;
            position: relative;
            user-select: none;
            touch-action: manipulation;
        }

        .cell {
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Arial Black', 'Helvetica Neue', sans-serif;
            font-weight: 900;
            cursor: default;
            transition: transform 0.1s;
        }

        /* –°—Ç–∏–ª—å —Ü–∏—Ñ—Ä: –ß–µ—Ä–Ω—ã–π –Ω–∞ –±–µ–ª–æ–º (–∏–ª–∏ –Ω–∞–æ–±–æ—Ä–æ—Ç, –Ω–æ –ø–æ —Å–ø–µ–∫–µ —á–µ—Ä–Ω—ã–π –Ω–∞ –±–µ–ª–æ–º –∫–ª–∞—Å—Å–∏–∫–∞) */
        .cell-content {
            width: 65%;
            height: 90%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(24px, 4vw, 48px);
            color: #000;
            background: transparent;
        }

        /* –°—Ç–∏–ª—å –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ (–º–∞—Å–∫–∞) */
        .cell.masked .cell-content {
            background: #fff;
            border: 2px solid #000;
            color: transparent; /* –°–∫—Ä—ã–≤–∞–µ–º —Ü–∏—Ñ—Ä—É */
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .cell.masked:active {
            transform: scale(0.95);
        }

        .cell.correct .cell-content {
            background: transparent;
            border: none;
            color: #000;
            opacity: 0.5;
            pointer-events: none;
        }

        /* –†–µ–∑—É–ª—å—Ç–∞—Ç—ã */
        #result-screen { display: none; text-align: center; padding: 20px; }
        #result-title { font-size: 32px; margin-bottom: 10px; }
        #result-desc { font-size: 18px; color: var(--text-muted); margin-bottom: 25px; }

        .disclaimer { margin-top: 20px; font-size: 11px; color: var(--text-muted); text-align: center; border-top: 1px solid var(--border-element); padding-top: 10px; }

        @media (max-width: 768px) {
            body { padding: 10px; }
            .card { padding: 15px; }
            h1 { font-size: 24px; }
            .nav-container { top: 10px; left: 10px; }
            .theme-btn { top: 10px; right: 10px; }
        }
    </style>
</head>
<body>

    <button class="theme-btn" onclick="toggleTheme()" title="–°–º–µ–Ω–∏—Ç—å —Ç–µ–º—É">üåì</button>

    <div class="nav-container">
        <button class="nav-toggle" onclick="toggleNav()">‚ò∞ –ú–µ–Ω—é</button>
        <nav class="nav-menu" id="nav-menu">
            <a href="../" class="nav-link">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –Ω–∏–∫–Ω–µ–π–º–æ–≤</a>
            <a href="../magic-8-ball/" class="nav-link">–®–∞—Ä-–æ—Ç–≤–µ—Ç—á–∏–∫</a>
            <a href="./" class="nav-link active">Project AI (–ê—é–º—É)</a>
        </nav>
    </div>

    <div class="card">
        <h1>Project AI: –¢–µ—Å—Ç –ê—é–º—É</h1>

        <!-- –≠–ö–†–ê–ù –ù–ê–°–¢–†–û–ï–ö -->
        <div id="setup-screen">
            <div class="control-group">
                <label for="digit-count">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ü–∏—Ñ—Ä (3-19):</label>
                <input type="number" id="digit-count" value="5" min="3" max="19">
            </div>
            <div class="control-group">
                <label for="display-time">–í—Ä–µ–º—è –ø–æ–∫–∞–∑–∞ (–º—Å):</label>
                <select id="display-time">
                    <option value="420">420 –º—Å (–≠–∫—Å–ø–µ—Ä—Ç)</option>
                    <option value="650" selected>650 –º—Å (–ù–æ—Ä–º–∞–ª—å–Ω—ã–π)</option>
                    <option value="1000">1000 –º—Å (–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞)</option>
                    <option value="2000">2000 –º—Å (–õ–µ–≥–∫–∏–π)</option>
                </select>
            </div>
            <div class="control-group">
                <label style="display:flex; align-items:center; gap:10px; cursor:pointer;">
                    <input type="checkbox" id="auto-progress" checked style="width:20px; height:20px;">
                    –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–≤—ã—à–∞—Ç—å —Å–ª–æ–∂–Ω–æ—Å—Ç—å
                </label>
            </div>
            <button onclick="startGame()">–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç</button>
        </div>

        <!-- –ò–ì–†–û–í–û–ô –≠–ö–†–ê–ù -->
        <div id="game-area">
            <div id="game-stats">
                <span id="level-display">–£—Ä–æ–≤–µ–Ω—å: 1</span>
                <span id="digits-left">–û—Å—Ç–∞–ª–æ—Å—å: 5</span>
            </div>
            <div id="grid-container"></div>
        </div>

        <!-- –≠–ö–†–ê–ù –†–ï–ó–£–õ–¨–¢–ê–¢–ê -->
        <div id="result-screen">
            <h2 id="result-title"></h2>
            <p id="result-desc"></p>
            <button onclick="resetGame()">–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞</button>
        </div>

        <div class="disclaimer">
            –≠—Ç–æ—Ç —Ç–µ—Å—Ç –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è—Ö –ò–Ω—Å—Ç–∏—Ç—É—Ç–∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø—Ä–∏–º–∞—Ç–æ–≤ –ö–∏–æ—Ç—Å–∫–æ–≥–æ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞ (Project AI).
        </div>
    </div>

<script>
    // --- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –°–æ—Å—Ç–æ—è–Ω–∏–µ ---
    const state = {
        phase: 'setup', // setup, display, play, result
        level: 1,
        digitCount: 5,
        displayTime: 650,
        autoProgress: true,
        currentSequence: 1,
        numbers: [], // {val, r, c}
        maxSuccessDigits: 0
    };

    // --- DOM –≠–ª–µ–º–µ–Ω—Ç—ã ---
    const screens = {
        setup: document.getElementById('setup-screen'),
        game: document.getElementById('game-area'),
        result: document.getElementById('result-screen')
    };
    const grid = document.getElementById('grid-container');
    const inputs = {
        count: document.getElementById('digit-count'),
        time: document.getElementById('display-time'),
        auto: document.getElementById('auto-progress')
    };
    const displays = {
        level: document.getElementById('level-display'),
        left: document.getElementById('digits-left'),
        resTitle: document.getElementById('result-title'),
        resDesc: document.getElementById('result-desc')
    };

    // --- –ù–∞–≤–∏–≥–∞—Ü–∏—è –∏ –¢–µ–º–∞ ---
    function toggleNav() { document.getElementById('nav-menu').classList.toggle('show'); }
    document.addEventListener('click', (e) => {
        if (!document.querySelector('.nav-container').contains(e.target)) {
            document.getElementById('nav-menu').classList.remove('show');
        }
    });
    function toggleTheme() {
        const body = document.body;
        const newTheme = body.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
        if (newTheme === 'light') body.setAttribute('data-theme', 'light');
        else body.removeAttribute('data-theme');
        localStorage.setItem('theme', newTheme);
    }
    if (localStorage.getItem('theme') === 'light') document.body.setAttribute('data-theme', 'light');

    // --- –õ–æ–≥–∏–∫–∞ –ò–≥—Ä—ã ---

    function getGridSize() {
        const w = window.innerWidth;
        if (w < 768) return { rows: 8, cols: 5 }; // –ú–æ–±–∏–ª—å–Ω—ã–π
        if (w < 1024) return { rows: 6, cols: 10 }; // –ü–ª–∞–Ω—à–µ—Ç
        return { rows: 7, cols: 16 }; // –î–µ—Å–∫—Ç–æ–ø
    }

    function startGame() {
        state.level = 1;
        state.maxSuccessDigits = 0;
        state.digitCount = parseInt(inputs.count.value);
        state.displayTime = parseInt(inputs.time.value);
        state.autoProgress = inputs.auto.checked;
        
        if (state.digitCount < 3) state.digitCount = 3;
        if (state.digitCount > 19) state.digitCount = 19;

        startRound();
    }

    function startRound() {
        state.phase = 'display';
        state.currentSequence = 1;
        
        updateUI();
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–∑–∏—Ü–∏–π
        const size = getGridSize();
        const positions = generatePositions(size.rows, size.cols, state.digitCount);
        
        if (!positions) {
            alert("–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å —Ü–∏—Ñ—Ä—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —É–º–µ–Ω—å—à–∏—Ç—å –∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–ª–∏ —É–≤–µ–ª–∏—á–∏—Ç—å —ç–∫—Ä–∞–Ω.");
            resetGame();
            return;
        }

        state.numbers = positions;
        renderGrid(size, true); // –ü–æ–∫–∞–∑–∞—Ç—å —Ü–∏—Ñ—Ä—ã

        // –¢–∞–π–º–µ—Ä –Ω–∞ —Å–∫—Ä—ã—Ç–∏–µ
        setTimeout(() => {
            if (state.phase === 'display') {
                state.phase = 'play';
                renderGrid(size, false); // –°–∫—Ä—ã—Ç—å —Ü–∏—Ñ—Ä—ã (–º–∞—Å–∫–∏)
            }
        }, state.displayTime);
    }

    function generatePositions(rows, cols, count) {
        // –ü–æ–ø—ã—Ç–∫–∞ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å —Ü–∏—Ñ—Ä—ã —Å —É—á–µ—Ç–æ–º –±—É—Ñ–µ—Ä–Ω–æ–π –∑–æ–Ω—ã
        // –ë—É—Ñ–µ—Ä–Ω–∞—è –∑–æ–Ω–∞: –Ω–µ–ª—å–∑—è —Å—Ç–∞–≤–∏—Ç—å –≤ —Å–æ—Å–µ–¥–Ω–∏–µ –∫–ª–µ—Ç–∫–∏ (—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ >= 2 –∫–ª–µ—Ç–æ–∫)
        // –ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–æ–±—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑, –µ—Å–ª–∏ –Ω–µ —É–¥–∞–µ—Ç—Å—è —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å
        
        for (let attempt = 0; attempt < 50; attempt++) {
            let placed = [];
            let available = [];
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º –ø—É–ª –≤—Å–µ—Ö —è—á–µ–µ–∫
            for(let r=0; r<rows; r++) {
                for(let c=0; c<cols; c++) {
                    available.push({r, c});
                }
            }

            let success = true;
            for (let i = 1; i <= count; i++) {
                if (available.length === 0) {
                    success = false;
                    break;
                }

                // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é
                const idx = Math.floor(Math.random() * available.length);
                const pos = available[idx];
                placed.push({ val: i, r: pos.r, c: pos.c });

                // –£–¥–∞–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –∏ —Å–æ—Å–µ–¥–µ–π –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö
                // –°–æ—Å–µ–¥–∏: –≤—Å–µ –∫–ª–µ—Ç–∫–∏ –≤–æ–∫—Ä—É–≥ –≤ —Ä–∞–¥–∏—É—Å–µ 1 (—á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å –∑–∞–∑–æ—Ä)
                available = available.filter(p => {
                    const dr = Math.abs(p.r - pos.r);
                    const dc = Math.abs(p.c - pos.c);
                    // –ï—Å–ª–∏ –∫–ª–µ—Ç–∫–∞ - —ç—Ç–æ —Å–∞–º–∞ –ø–æ–∑–∏—Ü–∏—è –∏–ª–∏ —Å–æ—Å–µ–¥ (dr<=1 –∏ dc<=1), —É–¥–∞–ª—è–µ–º
                    return !(dr <= 1 && dc <= 1);
                });
            }

            if (success) return placed;
        }
        return null; // –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å
    }

    function renderGrid(size, showNumbers) {
        grid.innerHTML = '';
        grid.style.gridTemplateRows = `repeat(${size.rows}, 1fr)`;
        grid.style.gridTemplateColumns = `repeat(${size.cols}, 1fr)`;

        // –°–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç—É –∑–∞–Ω—è—Ç—ã—Ö —è—á–µ–µ–∫ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
        const cellsMap = {};
        state.numbers.forEach(n => cellsMap[`${n.r},${n.c}`] = n);

        for (let r = 0; r < size.rows; r++) {
            for (let c = 0; c < size.cols; c++) {
                const cell = document.createElement('div');
                cell.className = 'cell';
                
                const numData = cellsMap[`${r},${c}`];
                if (numData) {
                    const content = document.createElement('div');
                    content.className = 'cell-content';
                    
                    if (showNumbers || numData.val < state.currentSequence) {
                        content.textContent = numData.val;
                    }
                    
                    if (!showNumbers) {
                        if (numData.val < state.currentSequence) {
                            // –£–∂–µ –Ω–∞–∂–∞—Ç—ã–µ (—Å–∫—Ä—ã—Ç—ã–µ/—É–¥–∞–ª–µ–Ω–Ω—ã–µ)
                            cell.classList.add('correct');
                        } else {
                            // –ï—â–µ –Ω–µ –Ω–∞–∂–∞—Ç—ã–µ (–º–∞—Å–∫–∏)
                            cell.classList.add('masked');
                            cell.onclick = () => handleInput(numData);
                        }
                    }
                    cell.appendChild(content);
                }
                grid.appendChild(cell);
            }
        }
    }

    function handleInput(numData) {
        if (state.phase !== 'play') return;

        if (numData.val === state.currentSequence) {
            // –ü—Ä–∞–≤–∏–ª—å–Ω–æ
            state.currentSequence++;
            updateUI();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —è—á–µ–π–∫—É (–≤–∏–∑—É–∞–ª—å–Ω–æ —É–±–∏—Ä–∞–µ–º –∫–≤–∞–¥—Ä–∞—Ç)
            // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Å–µ—Ç–∫—É –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã (–∏–ª–∏ –º–æ–∂–Ω–æ —Ç–æ—á–µ—á–Ω–æ –º–µ–Ω—è—Ç—å –∫–ª–∞—Å—Å)
            const size = getGridSize();
            renderGrid(size, false);

            if (state.currentSequence > state.digitCount) {
                // –ü–æ–±–µ–¥–∞ –≤ —Ä–∞—É–Ω–¥–µ
                state.maxSuccessDigits = state.digitCount;
                
                const savedBest = parseInt(localStorage.getItem('ayumu_best_score') || '0');
                if (state.maxSuccessDigits > savedBest) {
                    localStorage.setItem('ayumu_best_score', state.maxSuccessDigits);
                }

                setTimeout(() => {
                    if (state.autoProgress) {
                        state.digitCount++;
                        if (state.digitCount > 19) state.digitCount = 19;
                    }
                    state.level++;
                    startRound();
                }, 500);
            }
        } else {
            // –û—à–∏–±–∫–∞
            gameOver(false);
        }
    }

    function gameOver(win) {
        state.phase = 'result';
        displays.resTitle.textContent = win ? "–ü–æ–±–µ–¥–∞!" : "–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏";
        displays.resTitle.style.color = win ? 'var(--success-color)' : 'var(--error-color)';
        
        const bestScore = localStorage.getItem('ayumu_best_score') || 0;
        
        displays.resDesc.innerHTML = `
            –ü—Ä–æ–π–¥–µ–Ω–æ —Ä–∞—É–Ω–¥–æ–≤: ${state.level - 1}<br>
            –ú–∞–∫—Å–∏–º—É–º —Ü–∏—Ñ—Ä: ${state.maxSuccessDigits}<br>
            –õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${bestScore}
        `;
        updateUI();
    }

    function resetGame() {
        state.phase = 'setup';
        updateUI();
    }

    function updateUI() {
        screens.setup.style.display = state.phase === 'setup' ? 'block' : 'none';
        screens.game.style.display = (state.phase === 'display' || state.phase === 'play') ? 'flex' : 'none';
        screens.result.style.display = state.phase === 'result' ? 'block' : 'none';

        displays.level.textContent = `–£—Ä–æ–≤–µ–Ω—å: ${state.level}`;
        const left = state.digitCount - state.currentSequence + 1;
        displays.left.textContent = `–û—Å—Ç–∞–ª–æ—Å—å: ${left > 0 ? left : 0}`;
    }

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ—Å–∞–π–∑–∞ –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å–µ—Ç–∫–∏
    window.addEventListener('resize', () => {
        if (state.phase === 'display' || state.phase === 'play') {
            const size = getGridSize();
            renderGrid(size, state.phase === 'display');
        }
    });

</script>
</body>
</html>